(function(b){var a=function(f){var A,d,w;var t,h,v;var l;var e={UP:38,DOWN:40,TAB:9,RETURN:13,ESC:27,COMMA:188};function c(){d=b(f);A=b("<"+f.nodeName+" data-autocomplete/>");w=b('<div class="suggestions">').appendTo(A);w.append("<div>Suggestion 1</div><div>Suggestion 2</div><div>Suggestion 3</div>");w.hide();l=d.is("[data-autocomplete-multiple]");d.on("focus",p);d.on("input",j);d.on("keydown",k);d.on("blur",n);w.on("mousedown touchstart","> div",q);setTimeout(function(){var I=x(d[0]);d.after(A).appendTo(A);m(I)})}function p(){t=d.text();if(l){D()}}function j(){var J=d.text();var I;console.log("handleInput");if(!J.trim()){w.hide();t=J;return}if(t!==J){t=J;if(l){I=G()}else{I=J}d.trigger("autocomplete:request",[I,i])}}function k(I){if(!w.is(":visible")||w.find("div").length===0){return}switch(I.keyCode){case e.UP:I.preventDefault();u();return;case e.DOWN:I.preventDefault();E();return;case l&&e.COMMA:case e.RETURN:case e.TAB:y();w.hide();if(I.keyCode===e.TAB){return}I.preventDefault();return;case e.ESC:w.hide();return}}function n(){w.hide();if(l){F()}}function q(I){I.preventDefault();I.stopPropagation();B(b(I.currentTarget));w.hide()}var C=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;var H=/[,\s]*$/;var o=/\s*,\s*/;function i(I){var K="";var J=t.replace(C,"\\$&");var L=new RegExp("("+J+")","i");h=t.trim().split(o);v=I.map(g).filter(s);if(v.length===0){w.hide();return}v.forEach(function(N,P){var O=N.label;var M=(P===0)?' class="highlight"':"";if(!O){return}K+="<div"+M+">";K+=O.replace(L,"<strong>$1</strong>");K+="</div>"});w.html(K).show()}function s(I){if(!I){return}return h.indexOf(I.value)===-1}function g(I){if(!I){return}if(typeof I==="string"){return{label:I,value:I}}return I}function E(){var I=w.find(".highlight");var J=I.next();if(!J.length){return}I.removeClass("highlight");J.addClass("highlight")}function u(){var I=w.find(".highlight");var J=I.prev();if(!J.length){return}I.removeClass("highlight");J.addClass("highlight")}function y(){var I=w.find(".highlight");B(I)}function B(I){var J=v[I.index()];if(l){z(J.value)}else{d.text(J.value).focus();m(J.value.length)}d.trigger("autocomplete:select",[J])}function m(J){var K=document.createRange();var L=window.getSelection();var I=d[0].childNodes.length?d[0].childNodes[0]:d[0];K.setStart(I,J);K.collapse(true);L.removeAllRanges();L.addRange(K)}var r=/,/;function G(){var L=x(d[0]);var I=0;var M=t.split(r);var K;console.log("cursorAt",L,t[L-1]);for(var J=0;J<M.length;J++){K=M[J];if(I+K.length>=L){return t.substring(I,L).trim()}I+=K.length+1}console.log("getCurrentQuery: Could not find query!")}function z(L){var N=x(d[0]);var I=0;var P=t.split(r);var M;var K;var O;for(var J=0;J<P.length;J++){M=P[J];if(I+M.length>=N){K=t.substring(0,I).trim();O=t.substring(N);d.html(K+" "+L+",&nbsp;"+O);m((K+" "+L+", ").length);return}I+=M.length+1}console.log("replaceCurrentWordWith: Could not find word, returning last")}function x(L){var I=0;var N=L.ownerDocument||L.document;var M=N.defaultView||N.parentWindow;var K,J;if(typeof M.getSelection!=="undefined"){K=M.getSelection().getRangeAt(0);J=K.cloneRange();J.selectNodeContents(L);J.setEnd(K.endContainer,K.endOffset);I=J.toString().length}return I}function D(){var I=d.text();if(I){d.html(I.replace(H,",&nbsp;"))}}function F(){var I=d.text();d.text(I.replace(H,""))}c()};b.fn.contenteditableAutocomplete=function(){return this.each(function(){var d=b(this);var c=d.data("bs.contenteditableAutocomplete");if(!c){d.data("bs.contenteditableAutocomplete",(c=new a(this)))}})};b.fn.contenteditableAutocomplete.Constructor=a;b(document).on("focus.bs.contenteditableautocomplete.data-api","[data-autocomplete-spy]",function(c){var d=b(c.currentTarget);c.preventDefault();c.stopImmediatePropagation();d.removeAttr("data-autocomplete-spy").contenteditableAutocomplete();d.trigger(b.Event(c))})})(jQuery);